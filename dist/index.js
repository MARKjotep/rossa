// @bun
var nt=function(t,n,r,o){var i=arguments.length,s=i<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,e;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(t,n,r,o);else for(var f=t.length-1;f>=0;f--)if(e=t[f])s=(i<3?e(s):i>3?e(n,r,s):e(n,r))||s;return i>3&&s&&Object.defineProperty(n,r,s),s};var rt=(t,n)=>{if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,n)};import{Auth as bn}from"authored";var ot=(t)=>typeof t==="function";var C=(t)=>{return!isNaN(parseFloat(t))&&isFinite(t)};var it=(t)=>{return t instanceof Uint8Array||t instanceof ArrayBuffer||typeof t==="string"};var G=(t)=>typeof t==="string",x=(t)=>Array.isArray(t),st=(t)=>typeof t==="object";var et=(t)=>{return Number.isInteger(Number(t))};function ft(t,n){l(n).forEach(([r,o])=>{mt(t,r,{value:o,writable:!1,configurable:!1,enumerable:!0})})}var Y=(t)=>{return x(t)?t:[t]};class d{static set i(t){console.info(...Y(t))}static set e(t){console.error(...Y(t))}static set w(t){console.warn(...Y(t))}}var ut=(t,n)=>{let[r,o]=n.replace(/bytes=/,"").split("-").map((i,s)=>{let e=parseInt(i,10);return isNaN(e)?s===0?0:t-1:e});return[r,o,t]};var zt=(t)=>Array.from({length:t},(n,r)=>r),Ft="ABCDEFGHIJKLMNOPQRSTUVWXYZ",jt="abcdefghijklmnopqrstuvwxyz";var E=(t)=>JSON.stringify(t),pt=(t)=>{return JSON.parse(t)};var b=(t)=>{let n=Ft+jt,r=zt(10).join("");return Array.from({length:t},(o,i)=>n+(i?r:"")).reduce((o,i)=>{return o+=i.charAt(Math.floor(Math.random()*i.length))},"")};var J=(t,n)=>{let r=n==="/"?"":n;if(n.startsWith("#"))return t+n;return n.startsWith("/")?t+r:n};class a extends Map{obj(t){t&&l(t).forEach(([n,r])=>this.set(n,r))}map(t){t.forEach((n,r)=>{if(n instanceof a)this.set(r,n);else if(x(n)){if(this.lacks(r))this.set(r,[]);this.get(r).push(...n)}else if(st(n))this.ass(r,n);else this.set(r,n)})}ass(t,n){if(!this.has(t))this.set(t,{});R(this.get(t),n)}lacks(t){return!this.has(t)}init(t,n){return this.has(t)?this.get(t):this.set(t,n).get(t)}}var{values:N,keys:Z,entries:l}=Object;var{defineProperty:mt,assign:R}=Object;var q=(t)=>{return Object.keys(t).length};function ht(t){return class extends t{constructor(...n){super(...n);let r=new Map;return new Proxy(this,{get(o,i){let s=`__${i}`;if(!r.has(s)){let e=o[i];if(ot(e))e=function(...f){let u=`${s}_${JSON.stringify(f)}`;if(!r.has(u)){let m=o[i].apply(o,f);r.set(u,m)}return r.get(u)};r.set(s,e)}return r.get(s)},set(o,i,s){let e=`__${i}`;return r.set(e,s),!0}})}}}var lt=(t,n="",{maxAge:r,expires:o,path:i,domain:s,secure:e,httpOnly:f,sameSite:u})=>{if(r instanceof Date)r=r.getSeconds();if(o instanceof Date)o=o.toUTCString();else if(o===0)o=new Date().toUTCString();return[["Domain",s],["Expires",o],["Max-Age",r],["Secure",e],["HttpOnly",f],["Path",i],["SameSite",u]].reduce((p,[S,c])=>{if(c!==void 0)p.push(`${S}=${c}`);return p},[`${t}=${n}`]).join("; ")};var W=(t,n=!1)=>{if(C(t))return[+t,et(t)?"int":"float"];if(n&&/\.\w+$/.test(t))return[t,"file"];if(t==="/")return[t,"-"];if(t.length===36&&t.match(/\-/g)?.length===4)return[t,"uuid"];return[t,"string"]},y=(t)=>{let n=t.startsWith("/")?t:"/"+t,r=n.match(/(?<=\/)[^/].*?(?=\/|$)/g)??["/"],[o,i]=r.reduce(([s,e],f)=>{if(f.includes("<")){let u=f.match(/(?<=<)[^/].*?(?=>|$)/g);if(u?.length){let[m,p]=u[0].split(":");if(m)s.push(m),e.push(p||"_")}}else s.push(f===">"?"/":f);return[s,e]},[[],[]]);if(n.endsWith("/")&&n.length>1)o.push("/");return{parsed:o,args:i}};class ${storage;constructor(){this.storage=new a}cache(t,n){if(this.storage.lacks(t))this.storage.set(t,n());return this.storage.get(t)}}var Vt=["int","float","file","uuid","string"];class H{_storage;CC;constructor(){this._storage=new a,this.CC=new $}set(t){let{parsed:n,path:r}=t,o=E(n);if(!this._storage.get(o))this._storage.set(o,t);else throw`path: ${r} already used.`}get(t){let{parsed:n}=this.CC.cache(t,()=>y(t)),r={},o=this._storage.get(E(n));if(!o&&t!=="/")for(let i of this._storage.keys()){let s=[],e=pt(i);if(n.length===e.length){let f=e.map((p,S)=>{let c=W(n[S],n.length-1===S);if(p===c[0])return c[0];if(Vt.includes(c[1]))return s.push(c[0]),c[1];return p}),u=E(f);if(this._storage.has(u)){o=this._storage.get(u),o?.args.forEach((p,S)=>{r[p]=s[S]});break}}}return[o,r]}}class I{constructor(...t){t.forEach((n)=>{if(!this[n])this[n]=new H})}get(t){return this[t]}}class U{path="";parsed=[];args=[];constructor(t){ft(this,{path:t,...y(t)})}}class B{date;constructor(t){this.date=t?new Date(t):new Date}delta(t=null,n=!1){let r=B.delta(this.date.getTime(),t);return n?new Date(r):r}timed(t){if(!t)return this.date;return[["year","FullYear"],["month","Month"],["day","Date"],["hour","Hours"],["minute","Minutes"],["second","Seconds"]].reduce((r,[o,i])=>{let s=t[o];return s?new Date(r[`set${i}`](r[`get${i}`]()+s)):r},new Date(this.date))}static delta(t,n=null){return n?n-t:t-Date.now()}static local(t){return new Date(t).toLocaleString()}static get now(){return Date.now()}}var{file:tn}=globalThis.Bun;import{JWTInterface as kt}from"authored";class at{session;jwt;jwtInt;constructor(){this.jwtInt=new kt}init(t){this.session=t.session,this.jwt=t.jwt}}var h=new at;class T{__session;__jwt;get session(){if(!this.__session)this.__session=h.session.new;return this.__session}set session(t){this.__session=t}get jwt(){if(!this.__jwt)this.__jwt=h.jwt.new;return this.__jwt}set jwt(t){this.__jwt=t}get timedJWT(){return h.jwtInt.jwt()}setServerSession(t){let{__jwt:n,__session:r}=t;this.__session=r,this.__jwt=n}}var ct=async(t,n)=>{await h.session.saveSession(t,n)};async function gt({sid:t,jwtv:n,refreshjwt:r},o){let i=new T;if(t){if(i.session=await h.session.openSession(t),!i.session.new)o.session=!0}if(n){if(i.jwt=h.jwtInt.open(n,{hours:6}),!i.jwt.new)o.jwt=!0;if(r){if(!(await h.jwt.openSession(r)).new)o.jwt_refresh=!0}}if("session"in o||"jwt"in o)return i}var vt={session(...t){return A(t[0],t[2],"session")},jwt(...t){return A(t[0],t[2],"jwt")},jwt_refresh(...t){return A(t[0],t[2],"jwt_refresh")}},A=(t,n,r)=>{let o=n.value;return n.value=async function(i={}){if(r in i&&i.session)return delete i[r],o.call(t,i);return{error:401}},n};var nn=["GET","POST","PUT","DELETE","OPTIONS"];class St extends U{config;_class;options="";bytes;fileType="text/plain";fileSize=0;constructor(t,n={}){super(t);this.config=n}set serverClass(t){this._class=t,this.options=nn.filter((n)=>t.prototype[n.toLowerCase()]).join(", ")}get serverClass(){return this._class}async loadBytes(t="."){if(!this.config.preload)return;try{d.i=this.path;let n=this.path.startsWith("/")?this.path:"/"+this.path,r=tn(t+this.path);this.fileType=r.type,this.bytes=await r.bytes(),this.fileSize=this.bytes.byteLength}catch{throw`error: can't preload ${this.path}. File not found.`}}}var bt={path:Symbol("path"),wss:Symbol("wss"),file:Symbol("file"),folder:Symbol("folder"),error:Symbol("error")},rn=new I(...N(bt)),wt=(t)=>{let n=bt[t];if(!n)throw new Error("Invalid storage type");return rn[n]},w=(t,n,r={},o)=>{return(i)=>{let s=new St(n,r);if(i)s.serverClass=i;if(t==="file")s.loadBytes(o);return wt(t).set(s),i}},yt={args:{}};async function g(t){let[n,r]=wt(t).get(this.path);if(!n)return yt;let{requireSession:o}=n.config,i=void 0;if(o){if(i=await gt(await this.request.authgroup(),r),!i)return yt}return{serverPath:n,args:r,session:i}}class dt{}class L extends dt{dir;apt;base;_statics;constructor(t=".",n={}){super();this.dir=t;let{dir:r,base:o,clientDir:i}=n;if(r)this.dir=r;this.apt=i?i:"./client",this.base=o??"",this.files=(...s)=>{s.forEach((e)=>{let[f,u]=xt.call(this,e),m=f.replace(/^\.+/,""),p=m.startsWith("/")?m:"/"+m;w("file",p,u,this.apt)()})},this.folders=(...s)=>{s.forEach((e)=>{w("folder",...xt.call(this,e))()})},this.statics=(s={})=>{if(!this._statics)this._statics={};R(this._statics,s)},this.route=(s)=>{return w("path",this._base(s))},this.wss=(s,e={})=>{return w("wss",this._base(s),e)},this.error=(...s)=>{return(e)=>{if(s.length)s.forEach((f)=>{w("error",this._base(f.toString()),{})(e)});else w("error",this._base("404"),{})(e);return e}},this.redirect=(s,e={})=>{return new Response("",{status:302,headers:new Headers({...e,Location:this._base(s)})})}}_base(t){return J(this.base,t)}}function xt(t){let n=G(t);return[n?this._base(t):this._base(t[0]),n?{}:t[1]]}var{inflateSync:gn,serve:yn,write:Sn}=globalThis.Bun;class Rt extends a{}var z=new Rt;var F={async open(t){let n=t.data.wclass,{args:r,client:o}=t.data;if(n){n.ws=t;let i=n.id,s=q(o);if(!(i in o)){let e=s?"joiner":"maker";o[i]={role:e}}if(typeof n.init=="function")await n.init(r);if(n.broadcasting)n.ws.subscribe(n.path);await n.open()}else t.close()},async message(t,n){let r=t.data.wclass;if(r)await r.message(n)},async close(t,n,r){let o=t.data.wclass,i=t.data.client;if(o){if(await o.close(n,r),o.broadcasting)o.ws.unsubscribe(o.path);let s=o.id;if(delete i[s],q(i)===1)Z(i).forEach((e)=>{i[e].role="maker"})}}};async function j(){let{serverPath:t,args:n,session:r}=await g.call(this,"wss");if(!t)return this.status=426,"upgrade error";let{serverClass:o}=t;if(!o)return"upgrade error";let i=new o(this.request);r&&i.setServerSession(r);let s=i.path,e=Tt(s),f=e?.size??0,{broadcast:u,maxClient:m}=t.config;if(i.broadcasting=!!u,i.max=m??0,m&&f>=m)return this.status=400,"upgrade error";return this.request.upgradeConnection({data:{wclass:i,args:n,client:e}}),null}class Ct extends T{request;ws;path;id;broadcasting=!1;max=0;constructor(t){super();this.request=t;this.path=t.path,this.id=b(10)}open(){}message(t){}close(t,n){}set send(t){if(t)if(this.broadcasting)this.ws.publish(this.path,t);else this.ws.send(t)}get role(){let t=z.get(this.path);if(t&&t.has(this.id))return t.get(this.id)?.role}}var Tt=(t)=>{return z.init(t,new a)};var{deflateSync:pn,gzipSync:hn}=globalThis.Bun;var{Server:on,file:sn}=globalThis.Bun;class M{req;server;formData;url;method;__cookies=new Map;constructor(t,n){this.req=t;this.server=n;this.url=new URL(t.url),this.method=this.req.method.toLowerCase()}async json(){return await this.req.json()}async form(){if(this.isForm){if(!this.formData)this.formData=await this.req.formData();return this.formData}return new FormData}async authgroup(){let{cookies:t,auth:n}=this,r=t.get("session")??"",o=n??"",i="",s=this.isForm?await this.form():void 0;if(s){let e=s.get("refresh_token");i=e?e.toString():""}return{sid:r,jwtv:o,refreshjwt:i}}upgradeConnection(t={}){return!!this.server?.upgrade(this.req,t)}get auth(){let t=this.headers.get("authorization");if(t){let[n,r]=t.split(" ",2);if(n.trim()=="Bearer")return r.trim()}}get accept(){return this.headers.get("accept")}get contentType(){return this.headers.get("content-type")}get cookies(){if(!this.__cookies.size){let t=this.headers.get("cookie");if(t){let n=t.split(";").reduce((r,o)=>{let[i,s]=o.trim().split(/=(.*)/s);return r.push([i,s]),r},[]);this.__cookies=new Map(n)}}return this.__cookies}get headers(){return this.req.headers??new Headers}get ip(){return this.server?.requestIP(this.req)}get isForm(){let t=this.contentType;return t?t.indexOf("multipart/form-data")>=0||t.indexOf("x-www-form-urlencoded")>=0:!1}get path(){return this.url.pathname}get hash(){return this.url.hash}get fullPath(){let{pathname:t,hash:n}=this.url;return t+n}get parsed(){let{parsed:t}=y(this.path);return t}get searchParams(){return this.url.searchParams}get range(){return this.headers.get("range")??void 0}get isEventStream(){return this.accept?.includes("text/event-stream")}get isWSS(){return!!this.headers.get("upgrade")}get isFile(){let t=this.parsed.slice().pop();return t?W(t,!0).pop()==="file":!1}get type(){return sn(this.path).type}get upgrade(){return this.headers.get("upgrade")}get request(){return this.req}get signal(){return this.req.signal}}M=nt([ht,rt("design:paramtypes",[typeof Request==="undefined"?Object:Request,typeof on==="undefined"?Object:on])],M);class Et{ctrl;intervalID=[];constructor(t){this.ctrl=t}push(t,n=2000){if(this.ctrl){let r=setInterval(()=>{let{id:o,retry:i,data:s,event:e,end:f}=t();if(this.ctrl){let u=f?"end":s;if(i){let m=i>2000?i:2000;this.ctrl.enqueue(`retry: ${m}\\n`)}if(this.ctrl.enqueue(`id: ${o}\\n`),e&&this.ctrl.enqueue(`event: ${e}\\n`),typeof u=="object")this.ctrl.enqueue("data: "+JSON.stringify(u)+"\\n\\\n");else this.ctrl.enqueue("data: "+JSON.stringify({message:u})+"\\n\\n");f&&this.close()}},n>1000?n:1000);this.intervalID.push(r)}}close(){if(this.intervalID.length)this.intervalID.forEach((t)=>{clearInterval(t)}),this.intervalID=[];this.ctrl?.close()}}async function qt(t,n,r){this.status=200,this.header={"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"};let o=this.request,i=new ReadableStream({async start(e){t.stream=new Et(e),await r.call(t,n),o.signal.addEventListener("abort",()=>{if(t.stream?.close(),t.stream?.intervalID.length)e.close()})}}),s=await r.call(t,n);if(typeof s==="object"&&"error"in s)return this.status=s.error,null;return i}async function Bt(t){let n=h.jwtInt.save(t);return t.access_token=n,await h.jwt.saveSession(t,this.headers),{access_token:n,refresh_token:t.sid,status:"ok"}}function Mt(t){return this.status=403,{error:t}}async function Ot(t){let{jwtv:n,refreshjwt:r}=await this.request.authgroup();if(!r){if(n||!t.modified)return this.status=204,this.type="application/json",JSON.stringify({});return JSON.stringify(await Bt.call(this,t))}let o=await h.jwt.openSession(r),i=o.data.access_token,s={};if(n!==i)s=Mt.call(this,"tokens don't match.");else if(!h.jwtInt.verify(i,{days:5}))await h.jwt.saveSession(o,void 0,!0),s=Mt.call(this,"expired refresh_token.");else s=await Bt.call(this,o);return this.type="application/json",JSON.stringify(s)}var{file:en}=globalThis.Bun;async function Dt(){let t=this.path,{parsed:n}=y(this.path),r=n.slice(0,-1).join("/");this.path=r;let{serverPath:o}=await g.call(this,"folder");if(!o)return null;return this.path=t,await K.call(this)}async function Jt(){let{serverPath:t}=await g.call(this,"file");if(!t)return await Dt.call(this);if(t.bytes)return _.call(this,t.bytes,t.fileSize);return await K.call(this)}async function K(){try{let t=en(this.dir+this.path);if(t.type.startsWith("video/"))return _.call(this,t,t.size);else{let n=await t.bytes();return _.call(this,n,n.byteLength)}}catch{return`${this.path} file not found.`}}function _(t,n){let{type:r,range:o}=this.request;if(this.type=r,this.status=206,!o)return this.header={"Cache-Control":"max-age=86400, must-revalidate"},it(t)?this.compress("gzip",t):t;let[i,s,e]=ut(n,o);return this.header={"Content-Range":`bytes ${i}-${s}/${e}`,"Content-Length":n.toString()},t.slice(i,s+1)}async function Nt(t){return this.status=t.status,this.header=t.headers.toJSON(),await t.arrayBuffer()}import{ServerSide as fn}from"authored";function O(t,n){if(this.status=n||200,typeof t==="object")return this.type="application/json",JSON.stringify(t);return this.type="text/html",String(t)}async function Wt(t){if(t instanceof fn)return Ot.call(this,t);return O.call(this,t)}class D{type;render;data;constructor(t,n,r={}){this.type=t;this.render=n;this.data=r}static async jwt(t){return new D("jwt",t)}}async function $t(t,n=!1){let{type:r,render:o,data:i}=t;switch(r){case"jwt":return"jwt"}return"render"}function un(t){return this.status=t??204,null}async function mn(t){let{header:n,status:r,__session:o}=t;if(q(n))this.header=n;if(r)this.status=r;o&&await ct(o,this.headers)}async function P(t,n,r=!1){if(!n)return un.call(this,t.status);if(typeof n==="object"&&"error"in n&&C(n.error))return this.status=n.error,null;if(await mn.call(this,t),n instanceof Response)return await Nt.call(this,n);if(n instanceof D){if(t.status)this.status=t.status;return await $t.call(this,n,r)}switch(this.request.method){case"post":return Wt.call(this,n);default:return O.call(this,n)}}async function It(){let{serverPath:t,args:n,session:r}=await g.call(this,"path");if(!t)return this.request.isFile?await Jt.call(this):null;let{serverClass:o}=t;if(!o)return null;let i=new o(this.request,n);r&&i.setServerSession(r);let{isEventStream:s,method:e}=this.request;if(s&&i?.eventStream)return await qt.call(this,i,n,i.eventStream);if(e==="options")return this.status=204,this.options(t.options);if(i?.[e]){let f=await i[e]();return this.status=200,this.compress("deflate",await P.call(this,i,f)??"")}return null}async function Ut(){let t=this.path;this.path=this.status.toString();let{serverPath:n,args:r,session:o}=await g.call(this,"error");if(this.path=t,!n)return null;let{serverClass:i}=n;if(!i)return null;let s=new i(this.request,r);s.status=this.status;let{method:e}=this.request;if(s?.[e]){let f=await s[e]();return this.compress("deflate",await P.call(this,s,f,!0)??"")}return null}class Pt extends T{request;args;status;stream;path;hash;headers={};constructor(t,n={}){super();this.request=t;this.args=n;this.path=t.path,this.hash=t.hash}set header(t){R(this.headers,t)}get header(){return this.headers}set type(t){this.header={"Content-Type":t}}setCookie({key:t,val:n,path:r="/",days:o=31,httpOnly:i=!1}){let s=lt(t,n,{expires:new B().timed({day:o}),path:r,httpOnly:i,sameSite:"Strict"});this.header={"Set-Cookie":s}}deleteCookie(t){this.setCookie({key:t,val:"",days:0})}}class Qt{status=404;headers=new Headers({"Content-Type":"text/plain"});set header(t){l(t).forEach(([n,r])=>{this.headers.set(n,r)})}set type(t){this.headers.set("Content-Type",t)}options(t){return t+=", OPTIONS",this.header={Allow:t,"Access-Control-Allow-Methods":t,"Access-Control-Max-Age":"86400"},null}compress(t,n){let o=(t==="gzip"?hn:pn)(n);return this.header={"Content-Length":o.byteLength.toString(),"Content-Encoding":t},o}get init(){return{status:this.status,headers:this.headers}}}class Q extends Qt{dir;base;request;path="";constructor(t,n,r="./",o=""){super();this.dir=r;this.base=o;this.request=new M(t,n)}async response(){let{fullPath:t,isWSS:n}=this.request;this.path=this._base(t);let r=await(n?j:It).call(this);if(!r&&!this.request.isFile)r=await Ut.call(this);return new Response(r,this.init)}_base(t){return J(this.base,t)}}import{mkdirSync as ln,writeFileSync as an,existsSync as Gt}from"fs";var{file:cn}=globalThis.Bun;var{file:X,write:Xt}=globalThis.Bun;class V{fs;f_timed;data;key;dir;constructor({dir:t,fs:n,key:r}){this.dir=t+"/ffs",this.key=r,this.f_timed=Date.now(),this.data=new Map,this.fs=this.dir+`/${n}.json`}async init(){if(v(this.dir)&&k(this.fs,"{}"))X(this.fs).text().then((t)=>{let n=JSON.parse(t);this.data=new Map(l(n))}).catch((t)=>{})}async get(t){let n=this.data.get(t);if(n)return n;return null}async queue(){}async set(t){if(this.key in t){let n=await X(this.fs).text();if(n){let r=JSON.parse(n),o=t[this.key];r[o]=t,await Xt(this.fs,JSON.stringify(r))}this.data.set(t[this.key],t)}return!1}async delete(t){if(await this.get(t)){let n=await X(this.fs).text();if(n){let r=JSON.parse(n.toString());if(t in r)delete r[t],await Xt(this.fs,JSON.stringify(r));this.data.delete(t)}}}async json(){let t=await X(this.fs).text();return JSON.parse(t)}}var k=(t,n="")=>{if(Gt(t))return!0;return an(t,n,{flag:"wx"}),!0},v=(t)=>{if(Gt(t))return!0;return ln(t,{recursive:!0}),!0},Yt=(t,n)=>{if(!n)v(t),k(t+"/.env",`SECRET_KEY="${b(20)}"
TLS_KEY=""
TLS_CERT=""`)},tt=(t)=>{return l(process.env).filter(([n])=>n.startsWith("TLS_")).reduce((n,[r,o])=>{if(o){let i=r.replace("TLS_","").toLowerCase();n[i]=cn(t+o)}return n},{})};async function Zt(t){let{server:n,wss:r}=t,o=n.fn;delete n.fn;let{key:i,cert:s}=tt(this.dir),e=n.port||3000,f=yn({...n,...this._statics&&{static:this._statics},port:e,tls:{key:await i.text(),cert:await s.text()},fetch:async(m,p)=>{return await new Q(m,p,this.apt,this.base).response()},websocket:{sendPings:!0,perMessageDeflate:!0,...r,...F}});o?.(e);let u=()=>{f.stop(),process.exit(0)};process.on("SIGINT",u),process.on("SIGTERM",u)}var Ht=async(t,n,r="")=>{let{path:o,hostname:i,method:s,port:e,name:f}=t,m=await(await new Q({url:`http://${i??"127.0.0.1"}:${e||3000}${o}`,method:s??"GET"},void 0,n).response()).arrayBuffer(),p=o?.slice(1),c=(f?`/${f}`:p?"/"+p:"").split("#")[0];if(m.byteLength)await Sn(n+r+`${c}/index.html`,gn(m));return c+"/index"};import{config as wn}from"dotenv";class At extends L{html;serve;constructor(t={}){super(".",t);let{envPath:n,session:r}=t,o=this.dir+"/.private";Yt(o,n),wn({path:(n?n:o)+"/.env"});let i=r??new bn({dir:this.dir});h.init(i),this.html=async(s={})=>{s.path=this._base(s.path||"/");let e=await Ht(s,this.apt,this.base),f=new Date().toLocaleTimeString();d.i=`${e}.html @ ${f}`},this.serve=async(s={},e)=>await Zt.call(this,{server:s,wss:e}),this.folders("/")}}export{Ct as websocket,Pt as response,d as log,tt as getTLS,vt as auths,B as Time,At as Rossa,D as Render,a as Mapper,V as JSONCacher};
